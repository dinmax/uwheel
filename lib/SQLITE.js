/*! uw - v0.0.9 - 2015-04-08 */module.exports=new function(){var a,b=uw.config,c=require("q"),d=require("sqlite3").verbose(),e="sqlite 	",f=require("./log.js"),g=this;this.connect=function(){function e(){f.resolve()}var f=c.defer();return a=new d.Database(b.database.dbname,e),f.promise},this.getAll=function(b,d){function h(d){var e=c.defer();return a.all(b,function(a,b){a?e.reject(a):e.resolve(b)}),e.promise}function i(a){f.error(e,a)}return g.connect().then(h)["catch"](i)},this.run=function(b,d){function h(e){var f=c.defer();return a.run(b,d,function(a){a?f.reject(a):f.resolve({lastID:this.lastID,changes:this.changes})}),f.promise}function i(a){f.error(e,a)}return g.connect().then(h)["catch"](i)},this.query=function(a,b){var c=/(select)/gi;return c.test(a)?g.getAll(a,b):g.run(a,b)}};